# Initial Access Exploit Public-Facing Application

## Cited Resources:
[Microsoft: What is Azure Web Application Firewall on Azure Application Gateway?](https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/ag-overview#microsoft-sentinel) <br />

## Assumptions:
The Web Application Firewall is in Prevention mode <br />
The Azure Web Application Firewall solution is installed from the Sentinel Content hub.

## Instructions:

Walkthrough to find matched and blocked rules occuring on the Web Application Firewall

1. Go to [Azure Portal](https://portal.azure.com/) and Search for Microsoft Sentinel
![1-1](https://github.com/Tungsten66/Scenarios/assets/40893034/b6499c4f-f7a0-4ddb-96bb-77cd4a162458)
2. Click on your desired Sentinel Instance
![1-2](https://github.com/Tungsten66/Scenarios/assets/40893034/20813e65-cd76-4909-8018-895ea33c4b92)
3. Click on the Workbooks blade
4. Click on Templates
5. Search for Microsoft Web Application Firewall (WAF) - Azure WAF
6. Click on the workbook to select it
7. Click on View Template
![image](https://github.com/Tungsten66/Scenarios/assets/40893034/6fa1afa3-687d-4c53-97cd-8c0c55ed6ec3)
8. Review the workbook
![image](https://github.com/Tungsten66/Scenarios/assets/40893034/b096017c-d37c-4967-99aa-3717bb1544e4)
9. Scroll down to teh Message, full details section and click on the Action header to sort by Block and notice the ClientIP is the same IP.
![image](https://github.com/Tungsten66/Scenarios/assets/40893034/554c4621-fd1c-41a8-8fa2-262a76179ba6)
10. Search for nmap and you can review the same client is using nmap to scan your application
![image](https://github.com/Tungsten66/Scenarios/assets/40893034/fcfe55d3-53aa-41ff-9711-c560fe32d484)

## Post Condition:

> [!NOTE]
> Instructor led

Generate an incident in Sentinel when the above indicator of compromise occurs.

In Microsoft Sentinel

1. Click Analytics blade
2. Click Rule Templates
3. Type A potentially malicious web request was executed against a web server
4. Click on the Rule to highlight it
5. Click Create Rule
![image](https://github.com/Tungsten66/Scenarios/assets/40893034/fbf2b3df-f444-4401-8975-a81a3fe0588d)
6. Take default settings when creating the rule and Save
7. Review the new Incident created by navigating to the Incidents blade
![image](https://github.com/Tungsten66/Scenarios/assets/40893034/56f2ec13-5ead-4183-af51-814f31aa74f8)



